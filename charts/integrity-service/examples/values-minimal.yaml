# Minimal Configuration (Quick Start)
# The absolute minimum configuration needed to get integrity-service running
#
# Usage:
#   helm install integrity-service ./charts/integrity-service -f examples/values-minimal.yaml
#
# This example shows ONLY the values you MUST customize.
# All other values use sensible defaults from values.yaml
#
# Prerequisites:
#   1. PostgreSQL database accessible
#   2. Storage provider (AWS S3 or Azure Blob)
#   3. Azure Key Vault for credential signing
#   4. Auth service deployed
#   5. Required Kubernetes secrets created (see below)

# =============================================================================
# REQUIRED: Storage Provider
# =============================================================================

env:
  # REQUIRED: Choose storage backend
  integrityAppBlobStoreType: "aws_s3" # Options: "aws_s3", "azure_blob"

  # For AWS S3:
  integrityAppBlobStoreRegion: "us-east-1"
  integrityAppBlobStoreBucket: "YOUR-BUCKET-NAME"

  # For Azure Blob (uncomment if using Azure):
  # integrityAppBlobStoreType: "azure_blob"
  # integrityAppBlobStoreContainer: "YOUR-CONTAINER-NAME"

  # REQUIRED: Auth service URL
  integrityAppAuthUrl: "http://auth-service:8080"

  # REQUIRED: Auth signer type (Azure Key Vault)
  integrityAppAuthSignerConfigType: "azure_key_vault"

# =============================================================================
# REQUIRED: Database
# =============================================================================

# Database configuration uses environment variables
# Set these or use secrets:
#   integrityAppDbHost: "YOUR-DATABASE-HOST"
#   integrityAppDbName: "IntegrityServiceDB"
#   integrityAppDbUser: "postgres"

# =============================================================================
# REQUIRED: Secrets
# =============================================================================
#
# Create these secrets before installing:
#
# Database credentials:
# kubectl create secret generic database-credentials \
#   --from-literal=username=YOUR_DB_USER \
#   --from-literal=password=YOUR_DB_PASSWORD
#
# For AWS S3:
# kubectl create secret generic aws-s3-credentials \
#   --from-literal=access-key-id=YOUR_ACCESS_KEY \
#   --from-literal=secret-access-key=YOUR_SECRET_KEY
#
# For Azure Blob:
# kubectl create secret generic azure-storage-credentials \
#   --from-literal=account-name=YOUR_ACCOUNT \
#   --from-literal=account-key=YOUR_KEY \
#   --from-literal=connection-string=YOUR_CONNECTION_STRING
#
# Azure Key Vault (required for signing):
# kubectl create secret generic azure-key-vault-credentials \
#   --from-literal=client-id=YOUR_CLIENT_ID \
#   --from-literal=client-secret=YOUR_CLIENT_SECRET \
#   --from-literal=tenant-id=YOUR_TENANT_ID \
#   --from-literal=vault-url=https://YOUR-VAULT.vault.azure.net/

secrets:
  database:
    enabled: true
    name: "database-credentials"
    keys:
      username: "username"
      password: "password"

  # Choose based on your storage provider:
  storage:
    aws_s3:
      enabled: true
      name: "aws-s3-credentials"
      keys:
        accessKeyId: "access-key-id"
        secretAccessKey: "secret-access-key"

    # azure_blob:
    #   enabled: true
    #   name: "azure-storage-credentials"
    #   keys:
    #     accountName: "account-name"
    #     accountKey: "account-key"
    #     connectionString: "connection-string"

  secretManager:
    azure_key_vault:
      enabled: true
      name: "azure-key-vault-credentials"
      keys:
        clientId: "client-id"
        clientSecret: "client-secret"
        tenantId: "tenant-id"
        vaultUrl: "vault-url"
# =============================================================================
# OPTIONAL: Enable ingress for external access
# =============================================================================

# ingress:
#   enabled: true
#   className: "nginx"
#   annotations:
#     nginx.ingress.kubernetes.io/rewrite-target: /$2
#   hosts:
#     - host: governance.your-domain.com
#       paths:
#         - path: "/integrityService(/|$)(.*)"
#           pathType: ImplementationSpecific
#   tls:
#     - secretName: integrity-service-tls
#       hosts:
#         - governance.your-domain.com
