# =============================================================================
# GOVERNANCE PLATFORM - SECRETS SAMPLE
# =============================================================================
# This file documents all secrets required by the Governance Platform.
#
# WARNING: This is a TEMPLATE file - do NOT use these values in production
# WARNING: NEVER commit actual secrets to version control
#
# USAGE:
#   1. Copy this file to a secure location outside your repo
#   2. Replace all placeholder values with your actual credentials
#   3. Use with: helm install -f secrets.yaml -f values.yaml ...
#
# NOTE: The database password only needs to be set in global.secrets.database.values.password.
# The Bitnami PostgreSQL chart uses a placeholder password in values.yaml which is
# overridden at runtime by the existingSecret (platform-database).
#
# ALTERNATIVE: Create secrets manually in Kubernetes (recommended for production)
#   See the kubectl commands at the bottom of this file
# =============================================================================

global:
  secrets:
    # Enable automatic secret creation from values below
    # Set to false for production - create secrets manually instead
    create: true

    # =========================================================================
    # DATABASE CREDENTIALS
    # =========================================================================
    # Used by: governance-service, auth-service, integrity-service
    database:
      secretName: "platform-database"
      values:
        username: "postgres"
        password: "REPLACE_WITH_SECURE_PASSWORD" # Generate: openssl rand -base64 24

    # =========================================================================
    # AUTHENTICATION PROVIDER
    # =========================================================================
    # Choose ONE provider: auth0 OR keycloak
    auth:
      provider: "auth0" # Options: auth0, keycloak

      # --- Auth0 Configuration (M2M credentials only) ---
      # Used by: auth-service for backend authentication
      # Note: SPA client ID goes in governance-studio.config (see values files)
      auth0:
        secretName: "platform-auth0"
        values:
          # EQTYLab Platform API M2M credentials (token validation)
          clientId: "REPLACE_WITH_AUTH0_M2M_CLIENT_ID"
          clientSecret: "REPLACE_WITH_AUTH0_M2M_CLIENT_SECRET"
          # Auth Service Backend M2M credentials (Management API)
          mgmtClientId: "REPLACE_WITH_MGMT_CLIENT_ID"
          mgmtClientSecret: "REPLACE_WITH_MGMT_CLIENT_SECRET"

      # --- Keycloak Configuration ---
      # Used by: governance-studio, governance-service, auth-service
      # Uncomment and configure if using Keycloak instead of Auth0
      # keycloak:
      #   secretName: "platform-keycloak"
      #   values:
      #     url: "https://keycloak.example.com"
      #     realm: "governance"
      #     frontendClientId: "governance-platform-frontend"
      #     backendClientId: "governance-platform-backend"
      #     backendClientSecret: "REPLACE_WITH_KEYCLOAK_CLIENT_SECRET"  # Generate: openssl rand -hex 32
      #     tokenExchangePrivateKey: "REPLACE_WITH_TOKEN_EXCHANGE_PRIVATE_KEY"  # For token exchange signing

    # =========================================================================
    # STORAGE CREDENTIALS
    # =========================================================================
    # Configure credentials for your chosen storage provider(s)
    # Each service can use a different provider
    storage:
      # --- AWS S3 ---
      # Used by: governance-service, integrity-service (when using aws_s3)
      aws_s3:
        secretName: "platform-aws-s3"
        values:
          accessKeyId: "REPLACE_WITH_AWS_ACCESS_KEY_ID"
          secretAccessKey: "REPLACE_WITH_AWS_SECRET_ACCESS_KEY"

      # --- Azure Blob Storage ---
      # Used by: governance-service, integrity-service (when using azure_blob)
      azure_blob:
        secretName: "platform-azure-blob"
        values:
          accountName: "yourstorageaccount"
          accountKey: "REPLACE_WITH_AZURE_STORAGE_KEY"
          connectionString: "DefaultEndpointsProtocol=https;AccountName=yourstorageaccount;AccountKey=REPLACE_WITH_KEY;EndpointSuffix=core.windows.net"

      # --- Google Cloud Storage ---
      # Used by: governance-service (when storageProvider: "gcs")
      # Note: integrity-service does NOT support GCS
      gcs:
        secretName: "platform-gcs"
        values:
          # Base64-encoded service account JSON
          # Generate: cat service-account.json | base64 -w 0
          serviceAccountJson: "REPLACE_WITH_BASE64_ENCODED_SERVICE_ACCOUNT_JSON"

    # =========================================================================
    # SECRET MANAGER (for credential signing)
    # =========================================================================
    # Used by: auth-service for signing
    secretManager:
      provider: "azure_key_vault"

      azure_key_vault:
        enabled: true
        secretName: "platform-azure-key-vault"
        values:
          clientId: "REPLACE_WITH_AZURE_CLIENT_ID"
          clientSecret: "REPLACE_WITH_AZURE_CLIENT_SECRET"
          tenantId: "REPLACE_WITH_AZURE_TENANT_ID"
          vaultUrl: "https://your-vault.vault.azure.net/"

    # =========================================================================
    # PLATFORM ENCRYPTION
    # =========================================================================
    # Used by: governance-service, auth-service for encrypting sensitive data
    encryption:
      secretName: "platform-encryption-key"
      values:
        key: "REPLACE_WITH_ENCRYPTION_KEY" # Generate: openssl rand -base64 32

    # =========================================================================
    # GOVERNANCE WORKER CREDENTIALS
    # =========================================================================
    # Used by: governance-service worker for automated operations
    # Requires an Auth0 M2M application or Keycloak service account
    governanceWorker:
      secretName: "platform-governance-worker"
      values:
        encryptionKey: "REPLACE_WITH_WORKER_ENCRYPTION_KEY" # Generate: openssl rand -base64 32
        clientId: "REPLACE_WITH_M2M_CLIENT_ID"
        clientSecret: "REPLACE_WITH_M2M_CLIENT_SECRET"

    # =========================================================================
    # AI SERVICE CREDENTIALS (Optional)
    # =========================================================================
    # Used by: governance-service for AI-powered governance features
    governanceServiceAI:
      secretName: "platform-governance-service-ai"
      values:
        apiKey: "REPLACE_WITH_ANTHROPIC_API_KEY"

    # =========================================================================
    # AUTH SERVICE CREDENTIALS
    # =========================================================================
    # Used by: auth-service for API security
    authService:
      secretName: "platform-auth-service"
      values:
        apiSecret: "REPLACE_WITH_API_SECRET" # Generate: openssl rand -base64 32
        jwtSecret: "REPLACE_WITH_JWT_SECRET" # Generate: openssl rand -base64 32

    # =========================================================================
    # IMAGE REGISTRY CREDENTIALS
    # =========================================================================
    # Used by: All services for pulling container images from GHCR
    imageRegistry:
      secretName: "platform-image-pull-secret"
      registry: "ghcr.io"
      values:
        username: "your-github-username"
        password: "REPLACE_WITH_GITHUB_PAT" # GitHub PAT with read:packages scope
        email: "your-email@example.com"
# =============================================================================
# MANUAL SECRET CREATION (Recommended for Production)
# =============================================================================
# Instead of using create: true, create secrets manually with these commands:
#
# # Create namespace
# kubectl create namespace governance
#
# # Database credentials
# kubectl create secret generic platform-database \
#   --from-literal=username=postgres \
#   --from-literal=password="$(openssl rand -base64 24)" \
#   --namespace governance
#
# # Auth0 credentials (includes management API creds)
# kubectl create secret generic platform-auth0 \
#   --from-literal=client-id=YOUR_CLIENT_ID \
#   --from-literal=client-secret=YOUR_CLIENT_SECRET \
#   --from-literal=mgmt-client-id=YOUR_MGMT_CLIENT_ID \
#   --from-literal=mgmt-client-secret=YOUR_MGMT_CLIENT_SECRET \
#   --namespace governance
#
# # Keycloak credentials (alternative to Auth0)
# # kubectl create secret generic platform-keycloak \
# #   --from-literal=url=https://keycloak.example.com \
# #   --from-literal=realm=governance \
# #   --from-literal=frontend-client-id=governance-platform-frontend \
# #   --from-literal=backend-client-id=governance-platform-backend \
# #   --from-literal=backend-client-secret=YOUR_BACKEND_CLIENT_SECRET \
# #   --namespace governance
#
# # AWS S3 credentials (for AWS deployments)
# kubectl create secret generic platform-aws-s3 \
#   --from-literal=access-key-id=YOUR_ACCESS_KEY \
#   --from-literal=secret-access-key=YOUR_SECRET_KEY \
#   --namespace governance
#
# # Azure Blob credentials (for Azure deployments)
# kubectl create secret generic platform-azure-blob \
#   --from-literal=account-name=yourstorageaccount \
#   --from-literal=account-key=YOUR_STORAGE_KEY \
#   --from-literal=connection-string="DefaultEndpointsProtocol=https;..." \
#   --namespace governance
#
# # GCS credentials (for GCP deployments)
# # Note: integrity-service does NOT support GCS
# kubectl create secret generic platform-gcs \
#   --from-literal=service-account-json="$(cat service-account.json | base64 -w 0)" \
#   --namespace governance
#
# # Azure Key Vault credentials (for credential signing - REQUIRED)
# kubectl create secret generic platform-azure-key-vault \
#   --from-literal=client-id=YOUR_AZURE_CLIENT_ID \
#   --from-literal=client-secret=YOUR_AZURE_CLIENT_SECRET \
#   --from-literal=tenant-id=YOUR_AZURE_TENANT_ID \
#   --from-literal=vault-url=https://your-vault.vault.azure.net/ \
#   --namespace governance
#
# # Encryption key
# kubectl create secret generic platform-encryption-key \
#   --from-literal=encryption-key="$(openssl rand -base64 32)" \
#   --namespace governance
#
# # Governance worker credentials
# kubectl create secret generic platform-governance-worker \
#   --from-literal=encryption-key="$(openssl rand -base64 32)" \
#   --from-literal=client-id=YOUR_M2M_CLIENT_ID \
#   --from-literal=client-secret=YOUR_M2M_CLIENT_SECRET \
#   --namespace governance
#
# # AI credentials (optional)
# kubectl create secret generic platform-governance-service-ai \
#   --from-literal=api-key=YOUR_ANTHROPIC_API_KEY \
#   --namespace governance
#
# # Auth service credentials
# kubectl create secret generic platform-auth-service \
#   --from-literal=db-password="$(openssl rand -base64 24)" \
#   --from-literal=api-secret="$(openssl rand -base64 32)" \
#   --from-literal=jwt-secret="$(openssl rand -base64 32)" \
#   --namespace governance
#
# # Image pull secret for GitHub Container Registry
# kubectl create secret docker-registry platform-image-pull-secret \
#   --docker-server=ghcr.io \
#   --docker-username=YOUR_GITHUB_USERNAME \
#   --docker-password=YOUR_GITHUB_PAT \
#   --docker-email=YOUR_EMAIL \
#   --namespace governance
