# Keycloak Configuration Example
# Minimal configuration for deploying Auth Service with Keycloak.
# For all available values, see the chart's values.yaml and README.md.
#
# Usage:
#   Set these values under the `auth-service:` key in your umbrella values file.

image:
  tag: ""
  pullPolicy: Always

ingress:
  enabled: true
  className: "nginx"
  annotations:
    cert-manager.io/issuer: "letsencrypt-prod"
    nginx.ingress.kubernetes.io/use-regex: "true"
    nginx.ingress.kubernetes.io/rewrite-target: "/$2"
    nginx.ingress.kubernetes.io/enable-cors: "true"
    nginx.ingress.kubernetes.io/proxy-body-size: "64m"
    nginx.ingress.kubernetes.io/proxy-buffer-size: "16k"
    nginx.ingress.kubernetes.io/client-header-buffer-size: "16k"
    nginx.ingress.kubernetes.io/large-client-header-buffers: "4 16k"
  hosts:
    - host: "governance.your-domain.com"
      paths:
        - path: "/authService(/|$)(.*)"
          pathType: "ImplementationSpecific"
  tls:
    - secretName: "auth-service-tls"
      hosts:
        - "governance.your-domain.com"

config:
  # Keycloak Configuration
  idp:
    provider: "keycloak"
    issuer: "https://keycloak.your-domain.com/realms/governance"
    skipIssuerVerification: false
    keycloak:
      realm: "governance"
      adminUrl: "https://keycloak.your-domain.com"
      clientId: "governance-platform-frontend"
      enableUserManagement: true
      enableGroupSync: false

  # Token Exchange Configuration
  tokenExchange:
    enabled: true
    keyId: "auth-service-prod-001"

  # Key Vault Configuration (for DID keys)
  keyVault:
    provider: "azure_key_vault"
    azure:
      vaultUrl: "https://your-keyvault.vault.azure.net/"
      tenantId: "your-azure-tenant-id"

  # Extra environment variables for auth-service
  extraEnvVars:
    - name: AUTH_SERVICE_URL
      value: "http://governance-platform-auth-service:8080/api/v1/auth"
