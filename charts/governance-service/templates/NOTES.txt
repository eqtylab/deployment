{{- if .Values.enabled }}
Governance Service has been deployed!

Service URL (internal): http://{{ include "governance-service.fullname" . }}:{{ .Values.service.port }}

{{- if .Values.ingress.enabled }}
{{- range .Values.ingress.hosts }}
External URL: https://{{ .host }}/governanceService
{{- end }}
{{- else }}

To access the service, you need to enable ingress or use port-forwarding:
  kubectl port-forward svc/{{ include "governance-service.fullname" . }} 10001:{{ .Values.service.port }} -n {{ .Release.Namespace }}
  Then visit: http://localhost:10001/health
{{- end }}

Configuration:
  Environment: {{ .Values.config.appEnv | default ((.Values.global).environmentType | default "not set") }}
  Storage Provider: {{ .Values.config.storageProvider | default "not set" }}
  Log Level: {{ .Values.config.logLevel }}

{{- if eq .Values.config.storageProvider "azure" }}
  Azure Container: {{ .Values.config.azureStorageContainerName | default "not set" }}
{{- else if eq .Values.config.storageProvider "aws_s3" }}
  AWS Region: {{ .Values.config.awsS3Region | default "not set" }}
  AWS Bucket: {{ .Values.config.awsS3BucketName | default "not set" }}
{{- else if eq .Values.config.storageProvider "gcs" }}
  GCS Bucket: {{ .Values.config.gcsBucketName | default "not set" }}
{{- end }}

Database:
  Host: {{ .Values.externalDatabase.host | default (printf "%s-postgresql" .Release.Name) }}
  Database: {{ .Values.externalDatabase.name }}
  Migrations: {{ if .Values.migrations.runAtStartup }}enabled{{ else }}disabled{{ end }}

To check the status:
  kubectl get pods -l app.kubernetes.io/name={{ include "governance-service.name" . }} -n {{ .Release.Namespace }}

To view logs:
  kubectl logs -f deployment/{{ include "governance-service.fullname" . }} -n {{ .Release.Namespace }}

To check health:
  kubectl exec -it deployment/{{ include "governance-service.fullname" . }} -n {{ .Release.Namespace }} -- curl localhost:{{ .Values.service.port }}{{ .Values.config.healthPath }}

{{- if not .Values.config.storageProvider }}

⚠️  WARNING: Storage provider is not configured!
Please set: governance-service.config.storageProvider to "gcs", "azure", or "aws_s3"
{{- end }}

{{- if eq .Values.config.storageProvider "azure" }}
{{- if not .Values.config.azureStorageContainerName }}

⚠️  WARNING: Azure storage container is not configured!
Please set: governance-service.config.azureStorageContainerName
{{- end }}
{{- end }}

{{- if eq .Values.config.storageProvider "aws_s3" }}
{{- if or (not .Values.config.awsS3Region) (not .Values.config.awsS3BucketName) }}

⚠️  WARNING: AWS S3 configuration incomplete!
Please set: governance-service.config.awsS3Region and config.awsS3BucketName
{{- end }}
{{- end }}

{{- if eq .Values.config.storageProvider "gcs" }}
{{- if not .Values.config.gcsBucketName }}

⚠️  WARNING: GCS bucket is not configured!
Please set: governance-service.config.gcsBucketName
{{- end }}
{{- end }}
{{- end }}
